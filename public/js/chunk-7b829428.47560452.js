(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b829428"],{"0479":function(e,t,r){"use strict";var o=r("3a9e"),a=r.n(o);a.a},"3a9e":function(e,t,r){},"4bad":function(e,t,r){},"9fef":function(e,t,r){"use strict";var o=r("4bad"),a=r.n(o);a.a},d416:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"products"},[r("b-nav",{attrs:{tabs:""}},[r("b-nav-item",{on:{click:function(t){return e.setForm("Productos")}}},[e._v("Productos")]),r("b-nav-item",{on:{click:function(t){return e.setForm("Crear Producto")}}},[e._v("Crear Producto")]),r("b-nav-item",{on:{click:function(t){return e.setForm("Crear Categoria")}}},[e._v("Crear Categoria")])],1),r("div",{staticClass:"products__form"},["Productos"===e.title?r("product-list"):e._e(),"Crear Producto"===e.title?r("item-form"):e._e(),"Crear Categoria"===e.title?r("category-form"):e._e()],1)],1)},a=[],n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"form"},[r("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("b-form-group",{attrs:{label:"Número de referencia"}},[r("b-form-input",{attrs:{required:""},model:{value:e.form.referenceNumberCommon,callback:function(t){e.$set(e.form,"referenceNumberCommon",t)},expression:"form.referenceNumberCommon"}})],1),r("b-row",[r("b-col",[r("b-form-group",{attrs:{label:"Proveedor"}},[r("b-form-input",{attrs:{required:""},model:{value:e.form.provider,callback:function(t){e.$set(e.form,"provider",t)},expression:"form.provider"}})],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Fecha de compra"}},[r("b-form-datepicker",{attrs:{required:""},model:{value:e.form.buyDate,callback:function(t){e.$set(e.form,"buyDate",t)},expression:"form.buyDate"}})],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Tempoarada"}},[r("b-form-input",{attrs:{required:""},model:{value:e.form.season,callback:function(t){e.$set(e.form,"season",t)},expression:"form.season"}})],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Nombre del producto"}},[r("b-form-input",{attrs:{required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1),r("b-row",[r("b-col",[r("b-form-group",{attrs:{label:"Precio de compra"}},[r("b-form-input",{attrs:{type:"number",required:""},model:{value:e.form.purchasePrice,callback:function(t){e.$set(e.form,"purchasePrice",t)},expression:"form.purchasePrice"}})],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Precio de venta"}},[r("b-form-input",{attrs:{type:"number",required:""},model:{value:e.form.salePrice,callback:function(t){e.$set(e.form,"salePrice",t)},expression:"form.salePrice"}},[e._v(e._s(e.calculateDiscount))])],1)],1)],1),r("b-row",[r("b-col",[r("b-form-group",{attrs:{label:"En promocion"}},[r("b-form-checkbox",{attrs:{name:"promotionOn"},model:{value:e.form.promotionOn,callback:function(t){e.$set(e.form,"promotionOn",t)},expression:"form.promotionOn"}})],1)],1),r("b-col",[e.form.promotionOn?r("b-form-group",{attrs:{label:"Porcentaje"}},[r("b-form-input",{attrs:{disabled:!e.form.promotionOn,type:"number",required:""},model:{value:e.form.percentage,callback:function(t){e.$set(e.form,"percentage",t)},expression:"form.percentage"}})],1):e._e()],1),r("b-col",[e.form.promotionOn?r("b-form-group",{attrs:{label:"Precio con porcentaje aplicado"}},[r("b-form-input",{attrs:{disabled:"",type:"number"},model:{value:e.form.priceWithDiscount,callback:function(t){e.$set(e.form,"priceWithDiscount",t)},expression:"form.priceWithDiscount"}})],1):e._e()],1)],1),r("b-form-group",{attrs:{label:"Descripcion"}},[r("b-form-textarea",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),r("b-form-group",{attrs:{label:"Categoria"}},[r("b-form-select",{model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.categories,(function(t){return r("b-form-select-option",{key:t.name,attrs:{value:t._id}},[e._v(e._s(t.name))])})),1)],1),r("b-row",[r("b-col",[r("b-form-group",{attrs:{label:"Accesorio"}},[r("b-form-checkbox",{attrs:{name:"Accesorio"},model:{value:e.form.accesory,callback:function(t){e.$set(e.form,"accesory",t)},expression:"form.accesory"}})],1)],1),r("b-col",[e.form.accesory?r("b-form-group",{attrs:{label:"Total accesorios"}},[r("b-form-input",{attrs:{type:"number"},model:{value:e.form.totalStock,callback:function(t){e.$set(e.form,"totalStock",t)},expression:"form.totalStock"}})],1):e._e()],1)],1),e.form.accesory?e._e():r("div",{staticClass:"form__stock"},[r("b-form-group",{attrs:{label:"Stock"}},[r("hr"),e._l(e.form.stock,(function(t,o){return r("b-row",{key:o},[r("b-button",{staticClass:"mt-3",attrs:{variant:"link"},on:{click:function(t){return e.removeItem(o)}}},[r("i",{staticClass:"fas fa-minus"})]),r("b-button",{staticClass:"mt-3",attrs:{variant:"link"},on:{click:function(t){return e.addItem()}}},[r("i",{staticClass:"fas fa-plus"})]),r("b-col",[r("b-form-group",{attrs:{label:"Referencia"}}),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{placeholder:t.ref},model:{value:t.ref,callback:function(r){e.$set(t,"ref",r)},expression:"item.ref"}})],1),r("b-col",[r("b-form-group",{attrs:{label:"Color"}}),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{placeholder:t.color},model:{value:t.color,callback:function(r){e.$set(t,"color",r)},expression:"item.color"}})],1),r("b-col",e._l(t.quantity,(function(t,a){return r("b-row",{key:a,staticClass:"mt-3"},[r("b-col",[r("b-form-group",{attrs:{label:"Talla"}},[r("b-input",{model:{value:t.size,callback:function(r){e.$set(t,"size",r)},expression:"units.size"}})],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Cantidad"}},[r("b-input",{attrs:{type:"number"},model:{value:t.units,callback:function(r){e.$set(t,"units",r)},expression:"units.units"}})],1)],1),r("b-button",{attrs:{variant:"link"},on:{click:function(t){return e.addQuantity(o)}}},[r("i",{staticClass:"fas fa-plus"})]),r("b-button",{attrs:{variant:"link"},on:{click:function(t){return e.removeQuantity(o)}}},[r("i",{staticClass:"fas fa-minus"})])],1)})),1)],1)}))],2)],1),r("b-form-group",{attrs:{label:"Imagen"}},[r("b-form-file",{attrs:{required:"",type:"file",accept:"image/jpeg, image/png"},model:{value:e.form.img,callback:function(t){e.$set(e.form,"img",t)},expression:"form.img"}})],1),r("br"),r("b-overlay",{attrs:{show:e.loading,opacity:"0.6",rouded:""}},[r("b-button",{attrs:{block:"",variant:"outline-primary",type:"submit"}},[e._v("Crear")])],1)],1)],1)},c=[],s=(r("a4d3"),r("e01a"),r("4160"),r("a434"),r("b0c0"),r("a9e3"),r("159b"),r("96cf"),r("1da1")),i=r("5530"),l=r("bc3a"),u=r.n(l),m=r("2f62"),f={name:"ItemForm",data:function(){return{loading:!1,form:{provider:"",buyDate:"",season:"",name:"",purchasePrice:0,salePrice:0,percentage:0,promotionOn:!1,referenceNumberCommon:"",description:"",totalStock:0,stock:[{ref:"",color:"",quantity:[{size:"",units:0}]}],accesory:!1,category:"",img:null,priceWithDiscount:0}}},computed:Object(i["a"])({},Object(m["c"])(["categories"]),{calculateDiscount:function(){if(this.form.promotionOn){var e=this.form.salePrice*(this.form.percentage/100);return this.form.priceWithDiscount=this.form.salePrice-e,this.form.priceWithDiscount}}}),methods:Object(i["a"])({},Object(m["b"])(["getCategories"]),{onSubmit:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.form.accesory||e.form.stock.forEach((function(t){t.quantity.forEach((function(t){e.form.totalStock+=Number(t.units)}))})),r=new FormData,r.append("provider",e.form.provider),r.append("buyDate",e.form.buyDate),r.append("season",e.form.season),r.append("name",e.form.name),r.append("purchasePrice",e.form.purchasePrice),r.append("salePrice",0===e.form.priceWithDiscount?e.form.salePrice:e.form.priceWithDiscount),r.append("percentage",e.form.percentage),r.append("promotionOn",e.form.promotionOn),r.append("referenceNumberCommon",e.form.referenceNumberCommon),r.append("description",e.form.description),r.append("stock",JSON.stringify(e.form.stock)||[]),r.append("accesory",e.form.accesory),r.append("totalStock",e.form.totalStock),r.append("category",e.form.category),r.append("img",e.form.img),t.prev=17,e.loading=!0,t.next=21,u.a.post("".concat("http://localhost:3000","/product"),r,{headers:{"content-type":"multipart/form-data",authorization:sessionStorage.getItem("adminToken")}});case 21:e.$bvToast.toast("OK:)",{title:"Producto creado",variant:"success",solid:!0}),e.form.provider="",e.form.buyDate="",e.form.season="",e.form.name="",e.form.purchasePrice=0,e.form.salePrice=0,e.form.percentage=0,e.form.promotionOn=!1,e.form.referenceNumberCommon="",e.form.description="",e.form.stock=0,e.form.accesory=!1,e.form.totalStock=[{ref:"",color:"",quantity:[{size:"",units:0}]}],e.form.category="",e.form.img=null,t.next=43;break;case 39:t.prev=39,t.t0=t["catch"](17),e.$bvToast.toast("Error",{title:"No se pudo crear el producto",variant:"danger",solid:!0}),console.log(t.t0);case 43:return t.prev=43,e.loading=!1,t.finish(43);case 46:case"end":return t.stop()}}),t,null,[[17,39,43,46]])})))()},addQuantity:function(e){this.form.stock[e].quantity.push({size:"",units:0})},removeQuantity:function(e){1!==this.form.stock[e].quantity.length&&this.form.stock[e].quantity.splice(e,1)},removeItem:function(e){1!==this.form.stock.length&&this.form.stock.splice(e,1)},addItem:function(){this.form.stock.push({ref:"",color:"",quantity:[{size:"",units:0}]})}}),created:function(){this.getCategories()}},b=f,p=r("2877"),d=Object(p["a"])(b,n,c,!1,null,null,null),g=d.exports,v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"category"},[r("b-row",[r("b-col",[r("b-form-group",{staticClass:"mr-3",attrs:{label:"Nombre"}},[r("b-form-input",{attrs:{required:""},model:{value:e.category.name,callback:function(t){e.$set(e.category,"name",t)},expression:"category.name"}})],1)],1),r("b-col",[r("b-form-group",{attrs:{label:"Referencia"}},[r("b-form-input",{attrs:{type:"number",required:""},model:{value:e.category.referenceNumber,callback:function(t){e.$set(e.category,"referenceNumber",t)},expression:"category.referenceNumber"}})],1)],1),r("div",{staticClass:"category__add"},[r("b-button",{attrs:{variant:"primary"},on:{click:e.postCategory}},[e._v("Añadir")])],1)],1),r("b-row",[r("b-col",[r("b-list-group",e._l(e.categories,(function(t,o){return r("b-list-group-item",{key:o},[r("span",[e._v(e._s(t.name)+" "+e._s(t.referenceNumber))]),r("b-button",{attrs:{variant:"link"},on:{click:function(t){return e.removeCategory(o)}}},[r("i",{staticClass:"fas fa-minus"})])],1)})),1)],1)],1)],1)},h=[],k=(r("99af"),{name:"CategoryForm",data:function(){return{category:{name:"",referenceNumber:""}}},methods:Object(i["a"])({},Object(m["b"])(["getCategories"]),{postCategory:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=sessionStorage.getItem("adminToken"),t.next=4,u.a.post("".concat("http://localhost:3000","/category"),e.category,{headers:{authorization:r}});case 4:return e.category.name="",e.category.referenceNumber="",t.next=8,e.getCategories();case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.$bvToast.toast("Error",{title:"No se pudo crear la categoria",variant:"danger",solid:!0});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},removeCategory:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,o=sessionStorage.getItem("adminToken"),a=t.categories[e]._id,r.next=5,u.a.delete("".concat("http://localhost:3000","/category/").concat(a),{headers:{authorization:o}});case 5:return r.next=7,t.getCategories();case 7:r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](0),t.$bvToast.toast("Error",{title:"No se pudo borrar la categoria",variant:"danger",solid:!0});case 12:case"end":return r.stop()}}),r,null,[[0,9]])})))()}}),computed:Object(i["a"])({},Object(m["c"])(["categories"])),created:function(){this.getCategories()}}),y=k,C=(r("9fef"),Object(p["a"])(y,v,h,!1,null,"786a8b9a",null)),P=C.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-overlay",{attrs:{show:e.loading,opacity:"0.6",rouded:""}},[r("section",[r("b-table",{attrs:{id:"table",striped:"",hover:"",items:e.producst,fields:e.fields,"tbody-tr-class":e.rowClass},on:{"row-clicked":e.getSingleItem}}),r("b-pagination",{attrs:{"per-page":e.perPage,"aria-controls":"table","total-rows":e.rows},on:{change:e.changePage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)])},_=[],w={name:"ProductList",data:function(){return{loading:!1,currentPage:1,perPage:19,fields:[{key:"name",label:"Nombre"},{key:"referenceNumberCommon",label:"Nº Referencia"},{key:"accesory",label:"Accesorio",sortable:!0,formatter:function(e){return e?"Si":"No"}},{key:"category",label:"Categoria",sortable:!0,formatter:function(e){return e.name}},{key:"totalStock",label:"Stock",sortable:!0}]}},computed:Object(i["a"])({},Object(m["c"])(["producst"]),{rows:function(){return this.producst.length}}),methods:Object(i["a"])({},Object(m["b"])(["getAllProducts"]),{changePage:function(e){this.currentPage=20*(e-1),console.log(e)},rowClass:function(e,t){if(e&&"row"===t)return 0===e.totalStock?"table-danger":void 0},getSingleItem:function(e){this.loading=!0,this.$router.push({path:"/administration/product/".concat(e.referenceNumberCommon,"?from=").concat(this.currentPage)}),this.loading=!1}}),created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.getAllProducts();case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](1),e.$bvToast.toast("Error",{title:"Error al cargar los productos",variant:"danger",solid:!0});case 9:return t.prev=9,e.loading=!1,t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[1,6,9,12]])})))()}},O=w,$=Object(p["a"])(O,x,_,!1,null,null,null),N=$.exports,j={components:{ItemForm:g,CategoryForm:P,ProductList:N},data:function(){return{title:"Productos"}},methods:{setForm:function(e){switch(e){case"Productos":this.title=e;break;case"Crear Producto":this.title=e;break;case"Crear Categoria":this.title=e;break;default:this.title="Productos"}}}},S=j,D=(r("0479"),Object(p["a"])(S,o,a,!1,null,"e3ceec24",null));t["default"]=D.exports}}]);
//# sourceMappingURL=chunk-7b829428.47560452.js.map